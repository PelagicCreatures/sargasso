var SargassoModule=function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var s="object"==typeof t&&t&&t.Object===Object&&t,r=s,i="object"==typeof self&&self&&self.Object===Object&&self,n=r||i||Function("return this")(),a=n.Symbol;var o=function arrayMap$1(e,t){for(var s=-1,r=null==e?0:e.length,i=Array(r);++s<r;)i[s]=t(e[s],s,e);return i},c=Array.isArray,l=a,u=Object.prototype,h=u.hasOwnProperty,d=u.toString,f=l?l.toStringTag:void 0;var p=function getRawTag$1(e){var t=h.call(e,f),s=e[f];try{e[f]=void 0;var r=!0}catch(e){}var i=d.call(e);return r&&(t?e[f]=s:delete e[f]),i},b=Object.prototype.toString;var g=p,v=function objectToString$1(e){return b.call(e)},m=a?a.toStringTag:void 0;var w=function baseGetTag$5(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":m&&m in Object(e)?g(e):v(e)};var y=function isObjectLike$5(e){return null!=e&&"object"==typeof e},O=w,_=y;var j=function isSymbol$2(e){return"symbol"==typeof e||_(e)&&"[object Symbol]"==O(e)},S=o,E=c,x=j,A=a?a.prototype:void 0,k=A?A.toString:void 0;var $=function baseToString$1(e){if("string"==typeof e)return e;if(E(e))return S(e,baseToString$1)+"";if(x(e))return k?k.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t},C=$;var D=function toString$4(e){return null==e?"":C(e)};var M=function baseSlice$1(e,t,s){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(s=s>i?i:s)<0&&(s+=i),i=t>s?0:s-t>>>0,t>>>=0;for(var n=Array(i);++r<i;)n[r]=e[r+t];return n};var L=function castSlice$1(e,t,s){var r=e.length;return s=void 0===s?r:s,!t&&s>=r?e:M(e,t,s)},R=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var F=function hasUnicode$2(e){return R.test(e)};var z=function asciiToArray$1(e){return e.split("")},T="[\\ud800-\\udfff]",P="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",H="\\ud83c[\\udffb-\\udfff]",W="[^\\ud800-\\udfff]",I="(?:\\ud83c[\\udde6-\\uddff]){2}",V="[\\ud800-\\udbff][\\udc00-\\udfff]",q="(?:"+P+"|"+H+")"+"?",N="[\\ufe0e\\ufe0f]?",U=N+q+("(?:\\u200d(?:"+[W,I,V].join("|")+")"+N+q+")*"),B="(?:"+[W+P+"?",P,I,V,T].join("|")+")",G=RegExp(H+"(?="+H+")|"+B+U,"g");var Q=z,Z=F,K=function unicodeToArray$1(e){return e.match(G)||[]};var J=L,Y=F,X=function stringToArray$1(e){return Z(e)?K(e):Q(e)},ee=D;var te=function createCaseFirst$1(e){return function(t){t=ee(t);var s=Y(t)?X(t):void 0,r=s?s[0]:t.charAt(0),i=s?J(s,1).join(""):t.slice(1);return r[e]()+i}}("toUpperCase"),se=D,re=te;var ie=function capitalize$1(e){return re(se(e).toLowerCase())};var ne=function arrayReduce$1(e,t,s,r){var i=-1,n=null==e?0:e.length;for(r&&n&&(s=e[++i]);++i<n;)s=t(s,e[i],i,e);return s};var ae=function basePropertyOf$1(e){return function(t){return null==e?void 0:e[t]}}({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),oe=D,ce=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,le=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var ue=function deburr$1(e){return(e=oe(e))&&e.replace(ce,ae).replace(le,"")},he=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var de=function asciiWords$1(e){return e.match(he)||[]},fe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var pe=function hasUnicodeWord$1(e){return fe.test(e)},be="\\u2700-\\u27bf",ge="a-z\\xdf-\\xf6\\xf8-\\xff",ve="A-Z\\xc0-\\xd6\\xd8-\\xde",me="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",we="["+me+"]",ye="\\d+",Oe="[\\u2700-\\u27bf]",_e="["+ge+"]",je="[^\\ud800-\\udfff"+me+ye+be+ge+ve+"]",Se="(?:\\ud83c[\\udde6-\\uddff]){2}",Ee="[\\ud800-\\udbff][\\udc00-\\udfff]",xe="["+ve+"]",Ae="(?:"+_e+"|"+je+")",ke="(?:"+xe+"|"+je+")",$e="(?:['’](?:d|ll|m|re|s|t|ve))?",Ce="(?:['’](?:D|LL|M|RE|S|T|VE))?",De="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Me="[\\ufe0e\\ufe0f]?",Le=Me+De+("(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Se,Ee].join("|")+")"+Me+De+")*"),Re="(?:"+[Oe,Se,Ee].join("|")+")"+Le,Fe=RegExp([xe+"?"+_e+"+"+$e+"(?="+[we,xe,"$"].join("|")+")",ke+"+"+Ce+"(?="+[we,xe+Ae,"$"].join("|")+")",xe+"?"+Ae+"+"+$e,xe+"+"+Ce,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ye,Re].join("|"),"g");var ze=de,Te=pe,Pe=D,He=function unicodeWords$1(e){return e.match(Fe)||[]};var We=ne,Ie=ue,Ve=function words$1(e,t,s){return e=Pe(e),void 0===(t=s?void 0:t)?Te(e)?He(e):ze(e):e.match(t)||[]},qe=RegExp("['’]","g");var Ne=function createCompounder$2(e){return function(t){return We(Ve(Ie(t).replace(qe,"")),e,"")}},Ue=ie,Be=Ne((function(e,t,s){return t=t.toLowerCase(),e+(s?Ue(t):t)}));const Ge={},setValidator=(e,t)=>{Ge[e]=t};setValidator("isDefined",(e=>void 0!==e)),setValidator("isUnDefined",(e=>void 0===e)),setValidator("isNull",(e=>null===e)),setValidator("isElement",(e=>e&&(e instanceof Element||e instanceof Window))),setValidator("isEventTarget",(e=>e&&e instanceof EventTarget)),setValidator("isString",(e=>e&&("string"==typeof e||e instanceof String))),setValidator("isArray",(e=>e&&e instanceof Array)),setValidator("notEmpty",(e=>e instanceof Array?0!==e.length:""!==e)),setValidator("isEmpty",(e=>void 0===e||!e||(e instanceof Array?0===e.length:""===e))),setValidator("isObject",(e=>e&&e instanceof Object)),setValidator("isFunction",(e=>e&&"function"==typeof e));const validate=(e,t,s)=>{const r=s.map((e=>{if(e instanceof Array){return-1!==e.map((e=>Ge[e]&&Ge[e](t))).indexOf(!0)}return Ge[e]&&Ge[e](t)}));if(-1!==r.indexOf(!1))throw new Error("call to "+e+" invalid value: "+t+" "+s,0+r)},Qe=new WeakMap,isVisible=e=>(validate("isVisible element",e,["isDefined","isElement"]),!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),setMetaData=(e,t,s)=>{validate("setMetaData element",e,["isDefined","isElement"]),validate("setMetaData k",t,["isDefined","isString"]),validate("setMetaData v",s,[["isUnDefined","isNull","isString","isObject"]]);const r=Qe.get(e)||{};s?r[t]=s:delete r[t],Qe.set(e,r)},getMetaData=(e,t)=>{validate("getMetaData element",e,["isDefined","isElement"]),validate("getMetaData k",t,["isDefined","isString"]);const s=Qe.get(e)||{};return t?s[t]:s},on=function(e,t,s,r,i,n,a){"function"==typeof r&&(a=n,n=i,i=r,r=void 0),validate("on uid",e,["isDefined","notEmpty"]),validate("on container",t,["isDefined","isEventTarget"]),validate("on events",s,["isDefined","isString"]),validate("on fn",i,["isDefined","isFunction"]),validate("on selector",r,[["isEmpty","isString"]]);const o="on:"+e+"-"+s+"-"+r;if(getMetaData(t,o))return void console.error("Error: Sargasso utils.on: duplicate event handler specification. %o %s",t,o);const c={uid:e,events:s,selector:r||void 0,fn:n=>{a&&off(e,t,s,r),r?Array.from(t.querySelectorAll(r)).forEach((e=>{(n.target===e||e.contains(n.target))&&i(n,e)})):i(n)},options:n||!1};setMetaData(t,o,c),s.split(/[\s,]+/).forEach((e=>{t.addEventListener(e.trim(),c.fn,c.options)}))},off=function(e,t,s,r){validate("off uid",e,["isDefined","notEmpty"]),validate("off container",t,["isDefined","isEventTarget"]),validate("off events",s,["isDefined","isString"]),validate("off selector",r,[["isEmpty","isString"]]);const i="on:"+e+"-"+s+"-"+r,n=getMetaData(t,i);n&&(s.split(/[\s,]+/).forEach((e=>{t.removeEventListener(e.trim(),n.fn,n.options)})),setMetaData(t,i))},Ze={hasClass:(e,t)=>{validate("hasClass element",e,["isDefined","isElement"]),validate("hasClass cssClass",t,["isDefined","notEmpty","isString"]);return-1!==(e.className||"").split(/\s+/).indexOf(t)},addClass:(e,t)=>{validate("addClass element",e,["isDefined","isElement"]),validate("addClass addClasses",t,["isDefined","notEmpty",["isString","isArray"]]);const s=(e.className||"").split(/\s+/);Array.isArray(t)||(t=t.split(/[\s,]/)),t.forEach((e=>{e=e.trim(),-1===s.indexOf(e)&&s.push(e)})),e.className=s.join(" ")},removeClass:(e,t)=>{validate("removeClass element",e,["isDefined","isElement"]),validate("removeClass removeClasses",t,["isDefined","notEmpty",["isString","isArray"]]);const s=(e.className||"").split(/\s+/);Array.isArray(t)||(t=t.split(/[\s,]/)),t.forEach((e=>{e=e.trim(),-1!==s.indexOf(e)&&s.splice(s.indexOf(e),1)})),e.className=s.join(" ")},isVisible:isVisible,inViewPort:(e,t=window)=>{validate("inViewPort element",e,["isDefined","isElement"]);const s=e.getBoundingClientRect(),r=isVisible(e),i=s.bottom<0;let n;return n=t.self===window?s.top>(window.innerHeight||document.documentElement.clientHeight):s.top>t.clientHeight,r&&!n&&!i},setCSS:(e,t)=>{validate("css element",e,["isDefined","isElement"]),validate("css css",t,["isDefined",["isObject"]]);for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const r=Be(s);e.style[r]=null!==t[s]?t[s]:null}},setMetaData:setMetaData,getMetaData:getMetaData,on:on,off:off,once:function(e,t,s,r,i,n){"function"==typeof r&&(n=i,i=r,r=void 0),on(e,t,s,r,i,n,!0)},offAll:function(e){validate("offAll container",e,["isDefined","isEventTarget"]);const t=Qe.get(e)||{},s=[];for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&e.match(/^on:/)&&s.push(e);s.forEach((s=>{off(t[s].uid,e,t[s].events,t[s].selector)}))}};var Ke=function isObject$4(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Je=n,Ye=/\s/;var Xe=function trimmedEndIndex$1(e){for(var t=e.length;t--&&Ye.test(e.charAt(t)););return t},et=/^\s+/;var tt=function baseTrim$1(e){return e?e.slice(0,Xe(e)+1).replace(et,""):e},st=Ke,rt=j,it=/^[-+]0x[0-9a-f]+$/i,nt=/^0b[01]+$/i,at=/^0o[0-7]+$/i,ot=parseInt;var ct=Ke,now=function(){return Je.Date.now()},lt=function toNumber$1(e){if("number"==typeof e)return e;if(rt(e))return NaN;if(st(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=st(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=tt(e);var s=nt.test(e);return s||at.test(e)?ot(e.slice(2),s?2:8):it.test(e)?NaN:+e},ut=Math.max,ht=Math.min;var dt=function debounce(e,t,s){var r,i,n,a,o,c,l=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function invokeFunc(t){var s=r,n=i;return r=i=void 0,l=t,a=e.apply(n,s)}function leadingEdge(e){return l=e,o=setTimeout(timerExpired,t),u?invokeFunc(e):a}function shouldInvoke(e){var s=e-c;return void 0===c||s>=t||s<0||h&&e-l>=n}function timerExpired(){var e=now();if(shouldInvoke(e))return trailingEdge(e);o=setTimeout(timerExpired,function remainingWait(e){var s=t-(e-c);return h?ht(s,n-(e-l)):s}(e))}function trailingEdge(e){return o=void 0,d&&r?invokeFunc(e):(r=i=void 0,a)}function debounced(){var e=now(),s=shouldInvoke(e);if(r=arguments,i=this,c=e,s){if(void 0===o)return leadingEdge(c);if(h)return clearTimeout(o),o=setTimeout(timerExpired,t),invokeFunc(c)}return void 0===o&&(o=setTimeout(timerExpired,t)),a}return t=lt(t)||0,ct(s)&&(u=!!s.leading,n=(h="maxWait"in s)?ut(lt(s.maxWait)||0,t):n,d="trailing"in s?!!s.trailing:d),debounced.cancel=function cancel(){void 0!==o&&clearTimeout(o),l=0,r=c=i=o=void 0},debounced.flush=function flush(){return void 0===o?a:trailingEdge(now())},debounced};var ft=function listCacheClear$1(){this.__data__=[],this.size=0};var pt=function eq$2(e,t){return e===t||e!=e&&t!=t},bt=pt;var gt=function assocIndexOf$4(e,t){for(var s=e.length;s--;)if(bt(e[s][0],t))return s;return-1},vt=gt,mt=Array.prototype.splice;var wt=gt;var yt=gt;var Ot=gt;var _t=ft,jt=function listCacheDelete$1(e){var t=this.__data__,s=vt(t,e);return!(s<0)&&(s==t.length-1?t.pop():mt.call(t,s,1),--this.size,!0)},St=function listCacheGet$1(e){var t=this.__data__,s=wt(t,e);return s<0?void 0:t[s][1]},Et=function listCacheHas$1(e){return yt(this.__data__,e)>-1},xt=function listCacheSet$1(e,t){var s=this.__data__,r=Ot(s,e);return r<0?(++this.size,s.push([e,t])):s[r][1]=t,this};function ListCache$4(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}ListCache$4.prototype.clear=_t,ListCache$4.prototype.delete=jt,ListCache$4.prototype.get=St,ListCache$4.prototype.has=Et,ListCache$4.prototype.set=xt;var At=ListCache$4,kt=At;var $t=function stackClear$1(){this.__data__=new kt,this.size=0};var Ct=function stackDelete$1(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s};var Dt=function stackGet$1(e){return this.__data__.get(e)};var Mt=function stackHas$1(e){return this.__data__.has(e)},Lt=w,Rt=Ke;var Ft,zt=function isFunction$2(e){if(!Rt(e))return!1;var t=Lt(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Tt=n["__core-js_shared__"],Pt=(Ft=/[^.]+$/.exec(Tt&&Tt.keys&&Tt.keys.IE_PROTO||""))?"Symbol(src)_1."+Ft:"";var Ht=function isMasked$1(e){return!!Pt&&Pt in e},Wt=Function.prototype.toString;var It=function toSource$2(e){if(null!=e){try{return Wt.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Vt=zt,qt=Ht,Nt=Ke,Ut=It,Bt=/^\[object .+?Constructor\]$/,Gt=Function.prototype,Qt=Object.prototype,Zt=Gt.toString,Kt=Qt.hasOwnProperty,Jt=RegExp("^"+Zt.call(Kt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Yt=function baseIsNative$1(e){return!(!Nt(e)||qt(e))&&(Vt(e)?Jt:Bt).test(Ut(e))},Xt=function getValue$1(e,t){return null==e?void 0:e[t]};var es=function getNative$6(e,t){var s=Xt(e,t);return Yt(s)?s:void 0},ts=es(n,"Map"),ss=es(Object,"create"),rs=ss;var is=function hashClear$1(){this.__data__=rs?rs(null):{},this.size=0};var ns=function hashDelete$1(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},as=ss,os=Object.prototype.hasOwnProperty;var cs=function hashGet$1(e){var t=this.__data__;if(as){var s=t[e];return"__lodash_hash_undefined__"===s?void 0:s}return os.call(t,e)?t[e]:void 0},ls=ss,us=Object.prototype.hasOwnProperty;var hs=ss;var ds=is,fs=ns,ps=cs,bs=function hashHas$1(e){var t=this.__data__;return ls?void 0!==t[e]:us.call(t,e)},gs=function hashSet$1(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=hs&&void 0===t?"__lodash_hash_undefined__":t,this};function Hash$1(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}Hash$1.prototype.clear=ds,Hash$1.prototype.delete=fs,Hash$1.prototype.get=ps,Hash$1.prototype.has=bs,Hash$1.prototype.set=gs;var vs=Hash$1,ms=At,ws=ts;var ys=function isKeyable$1(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Os=function getMapData$4(e,t){var s=e.__data__;return ys(t)?s["string"==typeof t?"string":"hash"]:s.map},_s=Os;var js=Os;var Ss=Os;var Es=Os;var xs=function mapCacheClear$1(){this.size=0,this.__data__={hash:new vs,map:new(ws||ms),string:new vs}},As=function mapCacheDelete$1(e){var t=_s(this,e).delete(e);return this.size-=t?1:0,t},ks=function mapCacheGet$1(e){return js(this,e).get(e)},$s=function mapCacheHas$1(e){return Ss(this,e).has(e)},Cs=function mapCacheSet$1(e,t){var s=Es(this,e),r=s.size;return s.set(e,t),this.size+=s.size==r?0:1,this};function MapCache$2(e){var t=-1,s=null==e?0:e.length;for(this.clear();++t<s;){var r=e[t];this.set(r[0],r[1])}}MapCache$2.prototype.clear=xs,MapCache$2.prototype.delete=As,MapCache$2.prototype.get=ks,MapCache$2.prototype.has=$s,MapCache$2.prototype.set=Cs;var Ds=MapCache$2,Ms=At,Ls=ts,Rs=Ds;var Fs=At,zs=$t,Ts=Ct,Ps=Dt,Hs=Mt,Ws=function stackSet$1(e,t){var s=this.__data__;if(s instanceof Ms){var r=s.__data__;if(!Ls||r.length<199)return r.push([e,t]),this.size=++s.size,this;s=this.__data__=new Rs(r)}return s.set(e,t),this.size=s.size,this};function Stack$1(e){var t=this.__data__=new Fs(e);this.size=t.size}Stack$1.prototype.clear=zs,Stack$1.prototype.delete=Ts,Stack$1.prototype.get=Ps,Stack$1.prototype.has=Hs,Stack$1.prototype.set=Ws;var Is=Stack$1;var Vs=Ds,qs=function setCacheAdd$1(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ns=function setCacheHas$1(e){return this.__data__.has(e)};function SetCache$1(e){var t=-1,s=null==e?0:e.length;for(this.__data__=new Vs;++t<s;)this.add(e[t])}SetCache$1.prototype.add=SetCache$1.prototype.push=qs,SetCache$1.prototype.has=Ns;var Us=SetCache$1,Bs=function arraySome$1(e,t){for(var s=-1,r=null==e?0:e.length;++s<r;)if(t(e[s],s,e))return!0;return!1},Gs=function cacheHas$1(e,t){return e.has(t)};var Qs=function equalArrays$2(e,t,s,r,i,n){var a=1&s,o=e.length,c=t.length;if(o!=c&&!(a&&c>o))return!1;var l=n.get(e),u=n.get(t);if(l&&u)return l==t&&u==e;var h=-1,d=!0,f=2&s?new Us:void 0;for(n.set(e,t),n.set(t,e);++h<o;){var p=e[h],b=t[h];if(r)var g=a?r(b,p,h,t,e,n):r(p,b,h,e,t,n);if(void 0!==g){if(g)continue;d=!1;break}if(f){if(!Bs(t,(function(e,t){if(!Gs(f,t)&&(p===e||i(p,e,s,r,n)))return f.push(t)}))){d=!1;break}}else if(p!==b&&!i(p,b,s,r,n)){d=!1;break}}return n.delete(e),n.delete(t),d};var Zs=n.Uint8Array,Ks=pt,Js=Qs,Ys=function mapToArray$1(e){var t=-1,s=Array(e.size);return e.forEach((function(e,r){s[++t]=[r,e]})),s},Xs=function setToArray$1(e){var t=-1,s=Array(e.size);return e.forEach((function(e){s[++t]=e})),s},er=a?a.prototype:void 0,tr=er?er.valueOf:void 0;var sr=function equalByTag$1(e,t,s,r,i,n,a){switch(s){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!n(new Zs(e),new Zs(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ks(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=Ys;case"[object Set]":var c=1&r;if(o||(o=Xs),e.size!=t.size&&!c)return!1;var l=a.get(e);if(l)return l==t;r|=2,a.set(e,t);var u=Js(o(e),o(t),r,i,n,a);return a.delete(e),u;case"[object Symbol]":if(tr)return tr.call(e)==tr.call(t)}return!1};var rr=function arrayPush$1(e,t){for(var s=-1,r=t.length,i=e.length;++s<r;)e[i+s]=t[s];return e},ir=c;var nr=function baseGetAllKeys$1(e,t,s){var r=t(e);return ir(e)?r:rr(r,s(e))};var ar=function arrayFilter$1(e,t){for(var s=-1,r=null==e?0:e.length,i=0,n=[];++s<r;){var a=e[s];t(a,s,e)&&(n[i++]=a)}return n},or=function stubArray$1(){return[]},cr=Object.prototype.propertyIsEnumerable,lr=Object.getOwnPropertySymbols,ur=lr?function(e){return null==e?[]:(e=Object(e),ar(lr(e),(function(t){return cr.call(e,t)})))}:or;var hr=function baseTimes$1(e,t){for(var s=-1,r=Array(e);++s<e;)r[s]=t(s);return r},dr=w,fr=y;var pr=function baseIsArguments$1(e){return fr(e)&&"[object Arguments]"==dr(e)},br=y,gr=Object.prototype,vr=gr.hasOwnProperty,mr=gr.propertyIsEnumerable,wr=pr(function(){return arguments}())?pr:function(e){return br(e)&&vr.call(e,"callee")&&!mr.call(e,"callee")},yr=wr,Or={exports:{}};var _r=function stubFalse(){return!1};!function(e,t){var s=n,r=_r,i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,o=a&&a.exports===i?s.Buffer:void 0,c=(o?o.isBuffer:void 0)||r;e.exports=c}(Or,Or.exports);var jr=/^(?:0|[1-9]\d*)$/;var Sr=function isIndex$1(e,t){var s=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==s||"symbol"!=s&&jr.test(e))&&e>-1&&e%1==0&&e<t};var Er=function isLength$2(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},xr=w,Ar=Er,kr=y,$r={};$r["[object Float32Array]"]=$r["[object Float64Array]"]=$r["[object Int8Array]"]=$r["[object Int16Array]"]=$r["[object Int32Array]"]=$r["[object Uint8Array]"]=$r["[object Uint8ClampedArray]"]=$r["[object Uint16Array]"]=$r["[object Uint32Array]"]=!0,$r["[object Arguments]"]=$r["[object Array]"]=$r["[object ArrayBuffer]"]=$r["[object Boolean]"]=$r["[object DataView]"]=$r["[object Date]"]=$r["[object Error]"]=$r["[object Function]"]=$r["[object Map]"]=$r["[object Number]"]=$r["[object Object]"]=$r["[object RegExp]"]=$r["[object Set]"]=$r["[object String]"]=$r["[object WeakMap]"]=!1;var Cr=function baseIsTypedArray$1(e){return kr(e)&&Ar(e.length)&&!!$r[xr(e)]};var Dr=function baseUnary$1(e){return function(t){return e(t)}},Mr={exports:{}};!function(e,t){var r=s,i=t&&!t.nodeType&&t,n=i&&e&&!e.nodeType&&e,a=n&&n.exports===i&&r.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o}(Mr,Mr.exports);var Lr=Cr,Rr=Dr,Fr=Mr.exports,zr=Fr&&Fr.isTypedArray,Tr=zr?Rr(zr):Lr,Pr=hr,Hr=yr,Wr=c,Ir=Or.exports,Vr=Sr,qr=Tr,Nr=Object.prototype.hasOwnProperty;var Ur=function arrayLikeKeys$1(e,t){var s=Wr(e),r=!s&&Hr(e),i=!s&&!r&&Ir(e),n=!s&&!r&&!i&&qr(e),a=s||r||i||n,o=a?Pr(e.length,String):[],c=o.length;for(var l in e)!t&&!Nr.call(e,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||n&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Vr(l,c))||o.push(l);return o},Br=Object.prototype;var Gr=function isPrototype$1(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Br)};var Qr=function overArg$1(e,t){return function(s){return e(t(s))}}(Object.keys,Object),Zr=Gr,Kr=Qr,Jr=Object.prototype.hasOwnProperty;var Yr=zt,Xr=Er;var ei=Ur,ti=function baseKeys$1(e){if(!Zr(e))return Kr(e);var t=[];for(var s in Object(e))Jr.call(e,s)&&"constructor"!=s&&t.push(s);return t},si=function isArrayLike$1(e){return null!=e&&Xr(e.length)&&!Yr(e)};var ri=nr,ii=ur,ni=function keys$1(e){return si(e)?ei(e):ti(e)};var ai=function getAllKeys$1(e){return ri(e,ni,ii)},oi=Object.prototype.hasOwnProperty;var ci=function equalObjects$1(e,t,s,r,i,n){var a=1&s,o=ai(e),c=o.length;if(c!=ai(t).length&&!a)return!1;for(var l=c;l--;){var u=o[l];if(!(a?u in t:oi.call(t,u)))return!1}var h=n.get(e),d=n.get(t);if(h&&d)return h==t&&d==e;var f=!0;n.set(e,t),n.set(t,e);for(var p=a;++l<c;){var b=e[u=o[l]],g=t[u];if(r)var v=a?r(g,b,u,t,e,n):r(b,g,u,e,t,n);if(!(void 0===v?b===g||i(b,g,s,r,n):v)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var m=e.constructor,w=t.constructor;m==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof w&&w instanceof w||(f=!1)}return n.delete(e),n.delete(t),f},li=es(n,"DataView"),ui=ts,hi=es(n,"Promise"),di=es(n,"Set"),fi=es(n,"WeakMap"),pi=w,bi=It,gi="[object Map]",vi="[object Promise]",mi="[object Set]",wi="[object WeakMap]",yi="[object DataView]",Oi=bi(li),_i=bi(ui),ji=bi(hi),Si=bi(di),Ei=bi(fi),xi=pi;(li&&xi(new li(new ArrayBuffer(1)))!=yi||ui&&xi(new ui)!=gi||hi&&xi(hi.resolve())!=vi||di&&xi(new di)!=mi||fi&&xi(new fi)!=wi)&&(xi=function(e){var t=pi(e),s="[object Object]"==t?e.constructor:void 0,r=s?bi(s):"";if(r)switch(r){case Oi:return yi;case _i:return gi;case ji:return vi;case Si:return mi;case Ei:return wi}return t});var Ai=Is,ki=Qs,$i=sr,Ci=ci,Di=xi,Mi=c,Li=Or.exports,Ri=Tr,Fi="[object Arguments]",zi="[object Array]",Ti="[object Object]",Pi=Object.prototype.hasOwnProperty;var Hi=function baseIsEqualDeep$1(e,t,s,r,i,n){var a=Mi(e),o=Mi(t),c=a?zi:Di(e),l=o?zi:Di(t),u=(c=c==Fi?Ti:c)==Ti,h=(l=l==Fi?Ti:l)==Ti,d=c==l;if(d&&Li(e)){if(!Li(t))return!1;a=!0,u=!1}if(d&&!u)return n||(n=new Ai),a||Ri(e)?ki(e,t,s,r,i,n):$i(e,t,c,s,r,i,n);if(!(1&s)){var f=u&&Pi.call(e,"__wrapped__"),p=h&&Pi.call(t,"__wrapped__");if(f||p){var b=f?e.value():e,g=p?t.value():t;return n||(n=new Ai),i(b,g,s,r,n)}}return!!d&&(n||(n=new Ai),Ci(e,t,s,r,i,n))},Wi=y;var Ii=function baseIsEqual$1(e,t,s,r,i){return e===t||(null==e||null==t||!Wi(e)&&!Wi(t)?e!=e&&t!=t:Hi(e,t,s,r,baseIsEqual$1,i))},Vi=Ii;var qi=function isEqual(e,t){return Vi(e,t)};const Ni={},buildProxy=e=>({get(t,s){const r=Reflect.get(t,s);return r&&"object"==typeof r?new Proxy(r,buildProxy(e)):r},set:(t,s,r)=>(e.sync(s),Reflect.set(t,s,r)),deleteProperty:(t,s)=>(e.sync(s),Reflect.deleteProperty(t,s))});class ObservableObject{constructor(e,t={},s={}){if(this.id=e,Ni[this.id])throw new Error("ObservableObject "+e+" already exists.");this.bound={},this.data=new Proxy(t,buildProxy(this)),this.options=s,Ni[this.id]=this}destroy(){delete Ni[this.id],delete this.data,Object.keys(this.bound).forEach((e=>{Object.keys(this.bound[e]).forEach((t=>{this.unbind(t,e)}))}))}getBoundData(){return this.data}set(e,t){qi(this.get(e),t)||(this.data[e]=t)}get(e){return this.data[e]}delete(e){delete this.data[e]}syncAll(){Object.keys(this.data||{}).forEach((e=>{this.sync(e)}))}bind(e,t,s="*"){this.bound[s]||(this.bound[s]={}),this.bound[s][e]=t,Object.keys(this.data).forEach((e=>{t(this.id,e,this.get(e))}))}unbind(e,t="*"){this.bound[t]&&this.bound[t][e]&&delete this.bound[t][e]}sync(e){Object.keys(this.bound["*"]||{}).forEach((t=>{this.bound["*"][t](this.id,e,this.get(e))})),Object.keys(this.bound[e]||{}).forEach((t=>{this.bound[e][t](this.id,e,this.get(e))}))}}let Ui,Bi,Gi,Qi,Zi,Ki;class ObserverSubscriptionManager{constructor(e){this.options=e,this.observers=[],this.pendingAnimationFrame=void 0,this.frameQueue=[],this.sleeping=!0}subscribe(e){!this.observers.length&&this.sleeping&&this.wakeup(),this.observers.push(e)}unSubscribe(e){-1!==this.observers.indexOf(e)&&this.observers.splice(this.observers.indexOf(e),1),this.observers.length||this.sleep()}sleep(){this.sleeping=!0}wakeup(){this.sleeping=!1}notifyObservers(e,t){for(let s=0;s<this.observers.length;s++)this.observers[s][e]&&this.observers[s][e].apply(this.observers[s],t||[])}flushQueue(){this.pendingAnimationFrame&&(cancelAnimationFrame(this.pendingAnimationFrame),this.pendingAnimationFrame=void 0),this.frameQueue=[]}queueFrame(e){this.frameQueue.push(e.bind(this)),this.pendingAnimationFrame||(this.pendingAnimationFrame=requestAnimationFrame((()=>{this.processQueue()})))}processQueue(){this.pendingAnimationFrame=void 0;const e=this.frameQueue.slice(0);this.frameQueue=[];for(let t=0;t<e.length;t++)e[t]()}}class DOMWatcher extends ObserverSubscriptionManager{constructor(e={}){super(e),this.mutationHandler=dt(((e,t)=>{this.observeDOM(this.options.shadowDOM||document.body)}),25,{maxWait:100}),this.mutationObserver=new MutationObserver(this.mutationHandler,!1)}subscribe(e){super.subscribe(e),e.watchDOM(this.options.shadowDOM||document.body)}wakeup(){super.wakeup(),this.mutationObserver.observe(this.options.shadowDOM||document.body,{childList:!0,subtree:!0})}sleep(){super.sleep(),this.mutationObserver.disconnect()}observeDOM(e){this.notifyObservers("watchDOM",[e||this.options.shadowDOM||document.body])}}Ui=new DOMWatcher,Bi=new class ScrollWatcher extends ObserverSubscriptionManager{constructor(e={}){super(e),this.scrollElement=this.options.scrollElement||window,this.lastscroll=0,this.scrolling=!1}trigger(){this.scrolling||this.scrollLoop()}scrollLoop(){if(this.lastscroll!==this.scrollTop()){this.scrolling=!0,this.lastscroll=this.scrollTop(),this.watchScroll();const frame=()=>{this.scrollLoop()};this.queueFrame(frame)}else this.scrolling=!1}setOptions(e={}){this.sleep(),this.scrollElement=e.scrollElement||window,this.wakeup()}subscribe(e){super.subscribe(e),e.watchScroll()}wakeup(){super.wakeup(),Ze.on("theScrollWatcher",this.scrollElement,"scroll",(()=>{this.trigger()}))}sleep(){super.sleep(),Ze.off("theScrollWatcher",this.scrollElement,"scroll")}inViewPort(e){return Ze.inViewPort(e,this.scrollElement)}watchScroll(){this.notifyObservers("watchScroll")}scrollTop(e){if(this.scrollElement===window){if(void 0===e)return window.pageYOffset;window.scrollTo(0,e)}else{if(void 0===e)return this.scrollElement.scrollTop;this.scrollElement.scrollTop=e}}},Gi=new class ResizeWatcher extends ObserverSubscriptionManager{constructor(e){super(e),this.debounce=dt((()=>{this.watchResize()}),250)}subscribe(e){super.subscribe(e),e.watchResize()}wakeup(){super.wakeup(),window.addEventListener("resize",this.debounce,!1)}sleep(){super.sleep(),window.removeEventListener("resize",this.debounce)}watchResize(){this.notifyObservers("watchResize")}},Qi=new class OrientationWatcher extends ObserverSubscriptionManager{constructor(e){super(e),"onorientationchange"in window?Ze.addClass(document.body,"have-orientation"):Ze.addClass(document.body,"no-orientation"),this.debounce=dt((()=>{this.watchOrientation()}),250)}subscribe(e){super.subscribe(e),e.watchOrientation()}wakeup(){super.wakeup(),"onorientationchange"in window&&window.addEventListener("orientationchange",this.debounce,!1)}sleep(){super.sleep(),"onorientationchange"in window&&window.removeEventListener("orientationchange",this.debounce)}watchOrientation(){this.notifyObservers("watchOrientation")}},Zi=new class WorkerWatcher extends ObserverSubscriptionManager{constructor(e){super(e),this.workers={}}registerWorker(e,t){if(!this.workers[e]){let s=t,r=!1;if(!t.match(/^(http|\/)/i)){const e=new Blob([t],{type:"text/javascript"});s=URL.createObjectURL(e),r=!0}this.workers[e]={worker:new Worker(s),observers:[]},r&&URL.revokeObjectURL(s),this.workers[e].worker.onmessage=t=>{this.workerMessage(e,t)}}return this.workers[e].worker}subscribe(e,t){if(!this.workers[t])throw new Error("worker "+t+" does not exist");this.workers[t].observers.push(e),super.subscribe(e)}unSubscribe(e,t){if(!this.workers[t])throw new Error("worker "+t+" does not exist");const s=this.workers[t].observers;-1!==s.indexOf(e)&&s.splice(s.indexOf(e),1),s.length||(this.workers[t].worker.terminate(),delete this.workers[t]),super.unSubscribe(e)}workerMessage(e,t){this.workers[e].observers.forEach((s=>{s.workerMessage&&s.workerMessage(e,t)}))}wakeup(){super.wakeup()}sleep(){super.sleep()}},Ki=new class ObservableObjectWatcher extends ObserverSubscriptionManager{constructor(e){super(e),this.registeredObservableObjects={}}getObservable(e){return this.registeredObservableObjects[e]?this.registeredObservableObjects[e].observable:void 0}observableStart(e,t){const s=(e=>Ni[e])(e);if(s&&void 0!==t)throw new Error("ObservableObject "+e+" already exists, can't build.");return this.registeredObservableObjects[e]||(this.registeredObservableObjects[e]=s?{id:e,observable:s,observers:[],managed:!1}:{id:e,observable:new ObservableObject(e,t),observers:[],managed:!0},this.registeredObservableObjects[e].observable.bind(this.constructor.name,this.notify.bind(this))),this.registeredObservableObjects[e].observable}observableDestroy(e){if(!this.registeredObservableObjects[e])throw new Error("ObservableObject observableDestroy "+e+" does not exist");this.registeredObservableObjects[e].observable.unbind(this.constructor.name),this.registeredObservableObjects[e].observable.destroy(),delete this.registeredObservableObjects[e]}subscribe(e,t,s){this.registeredObservableObjects[t]||this.observableStart(t,s),this.registeredObservableObjects[t].observers.push(e),super.subscribe(e)}unSubscribe(e,t){if(!this.registeredObservableObjects[t])throw new Error("ObservableObject unSubscribe "+t+" does not exist");const s=this.registeredObservableObjects[t].observers;-1!==s.indexOf(e)&&s.splice(s.indexOf(e),1),!s.length&&this.registeredObservableObjects[t].managed&&this.observableDestroy(t),super.unSubscribe(e)}notify(e,t,s,r){if(!this.registeredObservableObjects[e])throw new Error("ObservableObject notify "+e+" does not exist");this.registeredObservableObjects[e].observers.forEach((i=>{i.observableChanged&&i.observableChanged(e,t,s,r)}))}};var Ji=Ne((function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}));let Yi=0;const Xi=[],en="customElements"in window,tn={},registerSargassoClass=(e,t)=>{if(tn[e])throw new Error("Sargasso class "+e+" is already registered.");if(tn[e]=t,en){const t=new Function("registeredClasses",`\n\t\t\treturn class ${e}Element extends HTMLElement {\n\t\t\t\tconstructor(element, options = {}) {\n\t\t\t\t\tsuper()\n\t\t\t\t\tthis.helperClass= '${e}'\n\t\t\t\t\tthis.helpers = []\n\t\t\t\t}\n\n\t\t\t\tconnectedCallback () {\n\t\t\t\t\tthis.helpers.push(new registeredClasses[this.helperClass](this,{isCustomElement:true}))\n\t\t\t\t\tif (this.hasAttributes()) {\n\t\t\t\t\t\tfor(let i = 0; i < this.attributes.length; i++) {\n\t\t\t\t\t\t\tif(this.attributes[i].name.match(/^sargasso-/)) {\n\t\t\t\t\t\t\t\tlet classname = this.attributes[i].name.replace(/^sargasso-/,'').split('-').map(word=> word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join('')\n\t\t\t\t\t\t\t\tif(!registeredClasses[classname]) {\n\t\t\t\t\t\t\t\t\tconsole.log('instantiate by attribute ' + this.attributes[i].name + ' > ' + classname + ' is not a sargasso class')\n\t\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.helpers.push(new registeredClasses[classname](this,{isCustomElement:true}))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.helpers.forEach((helper) => {\n\t\t\t\t\t\thelper.start()\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tdisconnectedCallback () {\n\t\t\t\t\tthis.helpers.forEach((helper) => {\n\t\t\t\t\t\thelper.sleep()\n\t\t\t\t\t\thelper.destroy()\n\t\t\t\t \t})\n\t\t\t\t\tthis.helpers = [] // nuke the reference for trash collection\n\t\t\t\t}\n\t\t\t}`)(tn);customElements.define("sargasso-"+Ji(e),t)}},sn=["DOMChanged","didScroll","didResize","didBreakpoint","enterViewport","exitViewport","enterFullscreen","exitFullscreen","newPage","elementEvent","workerOnMessage","observableChanged"];class Sargasso{constructor(e,t={}){validate("Sargasso constructor element",e,["isDefined","isElement"]),validate("Sargasso constructor options",t,["isDefined",["isObject"]]),this.uid=++Yi,this.element=e,t.shadowDOM&&(this._shadowDOM=e.attachShadow({mode:"open"}),this._shadowRoot=document.createElement("div"),this._shadowDOM.append(this._shadowRoot),this._hostElement=this.element,this.element=this._shadowRoot),this.options=t,this._pendingAnimationFrame=void 0,this._frameQueue=[],this._isInViewport=!1,this._workers={},this._observables={},this._template=void 0,this._templateArgs={},this._started=!1,this.render=dt((()=>{this._render()}),100,{maxWait:250})}start(){const e=this.getMetaData("registeredResponsiveControllers")||[];e.push(this),this.setMetaData("registeredResponsiveControllers",e),this.setMetaData(this.constructor.name,this),Xi.push(this),this._shadowDOM&&(this._shadowDOMWatcher||(this._shadowDOMWatcher=new DOMWatcher({shadowDOM:this._shadowRoot})),this._shadowDOMWatcher.subscribe(this)),this.options.watchDOM&&Ui.subscribe(this),(this.options.watchScroll||this.options.watchViewport)&&Bi.subscribe(this),(this.options.watchResize||this.options.watchViewport)&&Gi.subscribe(this),(this.options.watchOrientation||this.options.watchViewport)&&Qi.subscribe(this),this.elementListener=e=>{e.detail&&e.detail.sargassoEvent&&-1!==sn.indexOf(e.detail.sargassoEvent)?this[e.detail.sargassoEvent].apply(this,e.detail.sargassoEventOptions||[]):this.elementEvent(e)},this.element.addEventListener("sargasso",this.elementListener),this._started=!0}sleep(){this._shadowDOM&&this._shadowDOMWatcher.unSubscribe(this),this.options.watchDOM&&Ui.unSubscribe(this),(this.options.watchScroll||this.options.watchViewport)&&Bi.unSubscribe(this),(this.options.watchResize||this.options.watchViewport)&&Gi.unSubscribe(this),(this.options.watchOrientation||this.options.watchViewport)&&Qi.unSubscribe(this),this.element.removeEventListener("sargasso",this.elementListener),Ze.offAll(this.element),this._started=!1}DOMChanged(e){}didScroll(){}didResize(){}didBreakpoint(){}enterViewport(){}exitViewport(){}enterFullscreen(){}exitFullscreen(){}newPage(e,t){}elementEvent(e){}workerOnMessage(e,t){}observableChanged(e,t,s){this.render()}setMetaData(e,t){Ze.setMetaData(this.element,e,t)}getMetaData(e){return Ze.getMetaData(this.element,e)}on(e,t,s,r){Ze.on(this.constructor.name+"-"+this.uid,this.element,e,t,s,r)}off(e,t){Ze.off(this.constructor.name+"-"+this.uid,this.element,e,t)}once(e,t,s,r){Ze.once(this.constructor.name+"-"+this.uid,this.element,e,t,s,r)}notifyAll(e,t){if(-1===sn.indexOf(e))throw new Error("invalid event name "+e);for(let s=0;s<Xi.length;s++){const r=Xi[s];r!==this&&r[e]&&r[e].apply(r,t)}}notifyElement(e,t,s){if(-1===sn.indexOf(t))throw new Error("invalid event name "+t);const r=this.getMetaData("registeredResponsiveControllers");if(r)for(let e=0;e<r.length;e++){const i=r[e];i!==this&&i[t]&&i[t].apply(i,s)}}queueFrame(e){this._frameQueue.push(e.bind(this)),this._pendingAnimationFrame||(this._pendingAnimationFrame=requestAnimationFrame((()=>{this._processQueue()})))}wantFullscreen(e){e?this.enterFullscreen():this.exitFullscreen()}hasClass(e){return Ze.hasClass(this.element,e)}addClass(e){Ze.addClass(this.element,e)}removeClass(e){Ze.removeClass(this.element,e)}setCSS(e){Ze.setCSS(this.element,e)}isVisible(){return Ze.isVisible(this.element)}workerStart(e,t){return this._workers[e]=Zi.registerWorker(e,t),Zi.subscribe(this,e),this._workers[e]}workerPostMessage(e,t){t.uid||(t.uid=this.uid),this._workers[e]&&this._workers[e].postMessage(t)}getObservable(e){return this._observables[e]}getObservableData(e){return this._observables[e].data}observableStart(e,t){return Ki.subscribe(this,e,t),this._observables[e]=Ki.getObservable(e),this._observables[e]}observableStop(e){this._observables[e]&&(Ki.unSubscribe(this,e),delete this._observables[e])}observableStopAll(){for(const e in this._observables)this.observableStop(e)}setTemplate(e){this._template=e}setRenderer(e){this.renderer=e}setTemplateArgs(e={}){this._templateArgs=e,this.render()}getTemplateArgs(){const e=this._templateArgs||{};return JSON.parse(JSON.stringify(e))}_render(){this._template&&this.renderer&&this.renderer(this._template(this.getTemplateArgs()),this.element)}_flushQueue(){this._pendingAnimationFrame&&(cancelAnimationFrame(this._pendingAnimationFrame),this._pendingAnimationFrame=void 0),this._frameQueue=[]}_processQueue(){this._pendingAnimationFrame=void 0;const e=this._frameQueue.slice(0);this._frameQueue=[];for(let t=0;t<e.length;t++)e[t]()}_stopWorker(e){this._workers[e]&&(Zi.unSubscribe(this,e),delete this._workers[e])}_stopAllWorkers(){for(const e in this._workers)this._stopWorker(e)}destroy(){this._stopAllWorkers(),this.observableStopAll(),this._flushQueue(),this._started&&this.sleep();const e=this.getMetaData("registeredResponsiveControllers");e&&-1!==e.indexOf(this)&&(e.splice(e.indexOf(this),1),this.setMetaData("registeredResponsiveControllers",e)),this.setMetaData(this.constructor.name,null),this.element=null,-1!==Xi.indexOf(this)&&Xi.splice(Xi.indexOf(this),1)}watchDOM(e){e===this._shadowRoot?Ui.observeDOM(this._shadowRoot):this.DOMChanged(e)}watchScroll(){this.options.watchViewport&&this.inViewport(),this.didScroll()}watchResize(){this.options.watchViewport&&this.inViewport(),this.didResize()}watchOrientation(){!window.orientation||90!==window.orientation&&-90!==window.orientation?this.wantFullscreen(!1):this.wantFullscreen(!0)}inViewport(){Bi.inViewPort(this.element)?this._isInViewport||(this.enterViewport(),this._isInViewport=!0):this._isInViewport&&(this.exitViewport(),this._isInViewport=!1)}workerMessage(e,t){t.data.uid===this.uid&&this.workerOnMessage(e,t.data)}nativeRequestFullScreen(){if(document.fullscreenElement){if(document.fullscreenElement===this.element)return;document.exitFullscreen()}this.element.requestFullscreen()}nativeExitFullScreen(){document.fullscreenElement&&document.fullscreenElement===this.element&&document.exitFullscreen()}}registerSargassoClass("Sargasso",Sargasso);class LazyInstantiate extends Sargasso{constructor(e,t={}){t.watchScroll=!0,t.watchResize=!0,t.watchDOM=!0,t.immortal=!0,super(e,t)}didResize(){super.didResize(),this.lazyHandler()}didScroll(){super.didScroll(),this.lazyHandler()}DOMChanged(e){super.DOMChanged(e),this.lazyHandler(e)}lazyHandler(e=document){const t=e.querySelectorAll("[data-lazy-sargasso-class]");for(let e=0;e<t.length;e++){const s=t[e];if(Bi.inViewPort(s)){const r=s.getAttribute("data-lazy-sargasso-class").split(/\s*,\s*/);for(let s=0;s<r.length;s++){new tn[r[s]](t[e]).start()}s.removeAttribute("data-lazy-sargasso-class")}}}}registerSargassoClass("LazyInstantiate",LazyInstantiate);class SargassoSupervisor extends Sargasso{constructor(e,t={}){super(e,{watchDOM:!0,mortal:!1}),this.lazy=new LazyInstantiate(e,t)}start(){this.lazy.start(),super.start()}instantiate(e){const t=e.getAttribute("data-sargasso-class").split(/\s*,\s*/);for(let s=0;s<t.length;s++)try{new tn[t[s]](e).start()}catch(e){console.log("error instantiating "+t[s],e,tn)}e.removeAttribute("data-sargasso-class")}newPage(){this.doIt()}DOMChanged(e){this.doIt(e)}doIt(e=document.body){e.getAttribute("data-sargasso-class")&&this.instantiate(e);const t=e.querySelectorAll("[data-sargasso-class]");for(const e of t)this.instantiate(e);const s=[];for(let e=0;e<Xi.length;e++)Xi[e].options.immortal||Xi[e].options.isCustomElement||document.body.contains(Xi[e].element)||s.push(Xi[e]);for(let e=0;e<s.length;e++)s[e].destroy()}}registerSargassoClass("SargassoSupervisor",SargassoSupervisor);const rn=window.breakpoints||{widths:[{className:"breakpoint-phone",maxWidth:599},{className:"breakpoint-tablet",maxWidth:904},{className:"breakpoint-desktop",maxWidth:void 0}]};class Breakpoints extends Sargasso{constructor(e,t={}){t.watchResize=!0,super(e,t),this.options.widths=t.widths||rn,this.scale=void 0,this.widths=[],this.classes=[],this.debouncedDetectGeometry=dt((()=>{this.detectGeometry()}),100,{leading:!0,maxWait:250})}start(){super.start(),this.debouncedDetectGeometry()}didResize(){this.debouncedDetectGeometry()}detectGeometry(){const e=window.doBreakpoints(this.options.widths);if(e!==this.scale){const frame=()=>{this.notifyAll("didBreakpoint",[e])};this.queueFrame(frame)}this.scale=e}}registerSargassoClass("Breakpoints",Breakpoints);class HijaxLoader extends Sargasso{constructor(e,t={}){t.watchDOM=!0,t.immortal=!0,super(e,t),this.excludeRegex=new RegExp("^(//|http|javascript|mailto|#)","i"),this.currentPage=location.pathname+location.search,this.cachedMarkup={}}start(){const e=document.querySelectorAll("[data-hijax-skip-unchanged]");for(let t=0;t<e.length;t++){const s=e[t],r=s.getAttribute("id");this.cachedMarkup[r]=s.innerHTML}super.start(),window.addEventListener("popstate",(e=>{this.watchPopState(e)}),!1)}DOMChanged(e){super.DOMChanged(e),this.hijaxLinks(e)}watchPopState(e){location.pathname+location.search!==this.currentPage&&this.preFlight(location.pathname+location.search)}hijaxLinks(e){const t=e?e.getElementsByTagName("a"):this.element.getElementsByTagName("a");for(let e=0;e<t.length;e++){const s=t[e],r=s.getAttribute("href");!r||s.getAttribute("data-hijaxed")||s.getAttribute("target")||s.hasAttribute("data-no-hijax")||this.excludeRegex.exec(r)||(s.setAttribute("data-hijaxed",!0),s.addEventListener("click",(e=>{e.preventDefault(),this.setPage(r)}),!1))}}setPage(e,t){e===this.currentPage||t?this.preFlight(e):(history.pushState(null,null,e),this.watchPopState())}preFlight(e){if(!this.options.preFlight)return this.loadPage(e);this.options.preFlight(e,((t,s,r)=>{t&&(this.options.onError?this.options.onError("danger",t):alert("Error loading page: "+t)),s?this.currentPage=location.pathname+location.search:this.loadPage(r||e)}))}loadPage(e){this.queueFrame((()=>{Ze.addClass(document.body,"hijax-loading")})),this.options.onExitPage&&this.options.onExitPage();const t=new XMLHttpRequest;t.open("GET",e),t.setRequestHeader("Sargasso-Hijax",1),t.setRequestHeader("x-digitopia-hijax",1),this.options.onLoading&&(this.options.onLoading(),t.onreadystatechange=this.options.onLoading),t.onload=()=>{if(301===t.status||302===t.status||t.getResponseHeader("Sargasso-Location")){const e=t.getResponseHeader("Location")?t.getResponseHeader("Location"):t.getResponseHeader("Sargasso-Location");this.setPage(e)}else if(200===t.status){Bi.scrollTop(0),this.mergePage(t.responseText);const e=this.currentPage,frame=()=>{this.notifyAll("newPage",[e,location.pathname+location.search]),Ze.removeClass(document.body,"hijax-loading")};this.queueFrame(frame),this.currentPage=location.pathname+location.search}else{const e=t.getResponseHeader("Sargasso-Flash-Level")||"danger";let s=t.getResponseHeader("Sargasso-Flash-Message")||t.statusText;s||(s="Could not connect to server."),this.options.onError?this.options.onError(e,s):alert("Error loading page: "+s)}},t.send()}processScripts(e){Array.from(e).forEach((e=>{e.remove();const t=e.getAttribute("id");document.getElementById(t)||document.getElementsByTagName("head")[0].appendChild(e)}))}mergePage(e){const t=document.querySelectorAll("[data-ephemeral]");Array.from(t).forEach((e=>{e.remove()}));const s=e.split(/(<body[^>]*>|<\/body>)/gi),r=makeFragment(s[2]),i=document.querySelectorAll("[data-hijax]");for(let e=0;e<i.length;e++){const t=i[e],s=t.getAttribute("id"),n=r.getElementById(s);if(t.hasAttribute("data-hijax-skip-unchanged")){if(this.cachedMarkup[s]===n.innerHTML)continue;this.cachedMarkup[s]=n.innerHTML}const a=t.getAttribute("data-hijax-cache-key-selector");if(a&&n.querySelector(a)&&t.querySelector(a)&&t.querySelector(a).getAttribute("data-hijax-cache-key")===n.querySelector(a).getAttribute("data-hijax-cache-key"))continue;this.processScripts(n.querySelectorAll("script"));const frame=()=>{t.parentNode.replaceChild(n,t),this.options.onEnterPage&&this.options.onEnterPage(),this.hijaxLinks(n)};this.queueFrame(frame)}}}registerSargassoClass("HijaxLoader",HijaxLoader);const makeFragment=e=>{if(document.createRange&&document.createRange().createContextualFragment)return document.createRange().createContextualFragment(e);const t=document.createDocumentFragment(),s=document.createElement("div");return s.insertAdjacentHTML("afterBegin",e),t.appendChild(s),t};e.loadPageHandler=void 0;const nn={registerSargassoClass:registerSargassoClass,bootSargasso:(t={})=>{if(t.scrollElement&&Bi.setOptions(t),t.breakpoints){new Breakpoints(document.body,t.breakpoints).start()}if(t.hijax){const s=new HijaxLoader(document.body,t.hijax);s.start(),e.loadPageHandler=s.setPage.bind(s)}else e.loadPageHandler=e=>{document.location.href=e};const s=new SargassoSupervisor(document.body,t);return s.start(t),s},elementTools:Ze,validate:validate,setValidator:setValidator},an={theDOMWatcher:Ui,theScrollWatcher:Bi,theResizeWatcher:Gi,theOrientationWatcher:Qi,theWorkerWatcher:Zi,theObservableObjectWatcher:Ki},cn={liveElements:Xi,registeredClasses:tn,elementMetaData:Qe};return e.ObservableObject=ObservableObject,e.Sargasso=Sargasso,e.services=an,e.system=cn,e.utils=nn,Object.defineProperty(e,"__esModule",{value:!0}),e}({});
//# sourceMappingURL=sargasso.iife.min.js.map
